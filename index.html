<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- displays site properly based on user's device -->

  <link rel="icon" type="image/png" sizes="32x32" href="./assets/images/favicon-32x32.png">

  <title>Frontend Mentor | Contact form</title>

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="contact">
    <h1>Contact Us</h1>

    <form novalidate>
      <div class="form-group">
        <label for="fname">First Name</label>
        <input type="text" id="fname" name="first_name" required data-error="a">
        <span class="error-message"></span>
      </div>

      <div class="form-group">
        <label for="lname">Last Name</label>
        <input type="text" id="lname" name="last_name" required data-error="a">
        <span class="error-message"></span>
      </div>

      <div class="form-group span-all">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required data-error="a">
        <span class="error-message"></span>
      </div>
      <!-- https://issues.chromium.org/issues/40278914 -->
      <fieldset class="span-all">

        <legend>
          Query Type
        </legend>

        <div class="form-group">
          <input type="radio" id="general" name="query" value="general_enquiry" required data-error="a">
          <label for="general">General Enquiry</label>
        </div>

        <div class="form-group">
          <input type="radio" id="support" name="query" value="support" required data-error="abc">
          <label for="support">Support Request</label>
        </div>
        <span class="error-message"></span>
      </fieldset>

      <div class="form-group span-all">
        <label for="message">Message</label>
        <textarea name="message" id="message" required></textarea>
        <span class="error-message"></span>
      </div>

      <div class="form-group span-all">
        <input type="checkbox" name="consent" id="consent" required data-error="a">
        <label for="consent">I consent to being contacted by the team</label>
        <span class="error-message"></span>
      </div>

      <button class="span-all">Submit</button>
    </form>
  </div>



  <script>
    // Simple validation script
    const form = document.querySelector('form');

    // Function to validate any field
    function validateField(field) {
      // For radio buttons, check if any in the group are checked
      if (field.type === 'radio') {
        const isChecked = form.querySelector(`input[name="${field.name}"]:checked`);
        field = isChecked ? isChecked : field; // Use checked radio or first radio for validation
      }

      // Find the error message element
      const errorDiv = field.type === 'radio'
        ? field.closest('fieldset').querySelector('.error-message')
        : field.parentElement.querySelector('.error-message');

      // Check validity and show/hide error
      if (!field.validity.valid) {
        errorDiv.textContent = field.dataset.error || 'This field is required';
        errorDiv.classList.add('show');
        return false;
      } else {
        errorDiv.textContent = '';
        errorDiv.classList.remove('show');
        return true;
      }
    }

    // Add validation on blur/change
    form.querySelectorAll('input, textarea').forEach(input => {
      const event = input.type === 'radio' ? 'change' : 'blur';
      input.addEventListener(event, () => validateField(input));
    });

    // Validate entire form on submit
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      let isValid = true;

      // Validate all fields (skip duplicate radio validations)
      const validated = new Set();
      form.querySelectorAll('input, textarea').forEach(field => {
        const key = field.type === 'radio' ? `radio-${field.name}` : field.id;
        if (!validated.has(key)) {
          validated.add(key);
          if (!validateField(field)) isValid = false;
        }
      });

      if (isValid) {
        alert('Form submitted successfully!');
        console.log('Form data:', new FormData(form));
      } else {
        // Focus first invalid field
        form.querySelector(':invalid')?.focus();
      }
    });
  </script>
</body>

</html>